root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
indent_style = space
indent_size = 4
trim_trailing_whitespace = true

[*.{csproj,xml,json,yml,yaml}]
indent_size = 2

[*.cs]
# Using directives
dotnet_sort_system_directives_first = true
dotnet_separate_import_directive_groups = false

# var vs explicit type
csharp_style_var_for_built_in_types = true:suggestion
csharp_style_var_when_type_is_apparent = true:suggestion
csharp_style_var_elsewhere = true:suggestion

# Braces
csharp_prefer_braces = true:warning

# Namespace
csharp_style_namespace_declarations = file_scoped:warning

# --- Naming rules (evaluated most-specific first) ---

# 1. Interfaces: I + PascalCase
dotnet_naming_rule.interface_should_begin_with_i.severity = error
dotnet_naming_rule.interface_should_begin_with_i.symbols = interface_symbols
dotnet_naming_rule.interface_should_begin_with_i.style = begins_with_i

dotnet_naming_symbols.interface_symbols.applicable_kinds = interface
dotnet_naming_symbols.interface_symbols.applicable_accessibilities = *

dotnet_naming_style.begins_with_i.required_prefix = I
dotnet_naming_style.begins_with_i.capitalization = pascal_case

# 2. Type parameters: T + PascalCase
dotnet_naming_rule.type_parameter_should_begin_with_t.severity = error
dotnet_naming_rule.type_parameter_should_begin_with_t.symbols = type_parameter_symbols
dotnet_naming_rule.type_parameter_should_begin_with_t.style = begins_with_t

dotnet_naming_symbols.type_parameter_symbols.applicable_kinds = type_parameter
dotnet_naming_symbols.type_parameter_symbols.applicable_accessibilities = *

dotnet_naming_style.begins_with_t.required_prefix = T
dotnet_naming_style.begins_with_t.capitalization = pascal_case

# 3. Constant fields: PascalCase
dotnet_naming_rule.constants_should_be_pascal_case.severity = error
dotnet_naming_rule.constants_should_be_pascal_case.symbols = constant_symbols
dotnet_naming_rule.constants_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.constant_symbols.applicable_kinds = field
dotnet_naming_symbols.constant_symbols.applicable_accessibilities = *
dotnet_naming_symbols.constant_symbols.required_modifiers = const

# 4. Static readonly fields: PascalCase
dotnet_naming_rule.static_readonly_should_be_pascal_case.severity = error
dotnet_naming_rule.static_readonly_should_be_pascal_case.symbols = static_readonly_symbols
dotnet_naming_rule.static_readonly_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.static_readonly_symbols.applicable_kinds = field
dotnet_naming_symbols.static_readonly_symbols.applicable_accessibilities = *
dotnet_naming_symbols.static_readonly_symbols.required_modifiers = static, readonly

# 5. Private/private_protected instance fields: _camelCase
dotnet_naming_rule.private_fields_should_be_underscore_camel.severity = error
dotnet_naming_rule.private_fields_should_be_underscore_camel.symbols = private_field_symbols
dotnet_naming_rule.private_fields_should_be_underscore_camel.style = underscore_camel_case

dotnet_naming_symbols.private_field_symbols.applicable_kinds = field
dotnet_naming_symbols.private_field_symbols.applicable_accessibilities = private, private_protected

dotnet_naming_style.underscore_camel_case.required_prefix = _
dotnet_naming_style.underscore_camel_case.capitalization = camel_case

# 6. Internal fields: PascalCase (matches existing pattern in Builder classes)
dotnet_naming_rule.internal_fields_should_be_pascal_case.severity = error
dotnet_naming_rule.internal_fields_should_be_pascal_case.symbols = internal_field_symbols
dotnet_naming_rule.internal_fields_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.internal_field_symbols.applicable_kinds = field
dotnet_naming_symbols.internal_field_symbols.applicable_accessibilities = internal

# 7. Types (class, struct, enum, delegate): PascalCase
dotnet_naming_rule.types_should_be_pascal_case.severity = error
dotnet_naming_rule.types_should_be_pascal_case.symbols = type_symbols
dotnet_naming_rule.types_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.type_symbols.applicable_kinds = class, struct, enum, delegate
dotnet_naming_symbols.type_symbols.applicable_accessibilities = *

# 8. Non-field members (property, method, event): PascalCase
dotnet_naming_rule.members_should_be_pascal_case.severity = error
dotnet_naming_rule.members_should_be_pascal_case.symbols = member_symbols
dotnet_naming_rule.members_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.member_symbols.applicable_kinds = property, method, event
dotnet_naming_symbols.member_symbols.applicable_accessibilities = *

# 9. Parameters: camelCase
dotnet_naming_rule.parameters_should_be_camel_case.severity = error
dotnet_naming_rule.parameters_should_be_camel_case.symbols = parameter_symbols
dotnet_naming_rule.parameters_should_be_camel_case.style = camel_case_style

dotnet_naming_symbols.parameter_symbols.applicable_kinds = parameter
dotnet_naming_symbols.parameter_symbols.applicable_accessibilities = *

# 10. Local variables and functions: camelCase
dotnet_naming_rule.locals_should_be_camel_case.severity = error
dotnet_naming_rule.locals_should_be_camel_case.symbols = local_symbols
dotnet_naming_rule.locals_should_be_camel_case.style = camel_case_style

dotnet_naming_symbols.local_symbols.applicable_kinds = local, local_function
dotnet_naming_symbols.local_symbols.applicable_accessibilities = *

# 11. Namespace: PascalCase
dotnet_naming_rule.namespace_should_be_pascal_case.severity = error
dotnet_naming_rule.namespace_should_be_pascal_case.symbols = namespace_symbols
dotnet_naming_rule.namespace_should_be_pascal_case.style = pascal_case_style

dotnet_naming_symbols.namespace_symbols.applicable_kinds = namespace
dotnet_naming_symbols.namespace_symbols.applicable_accessibilities = *

# --- Dead code / unused members ---
dotnet_diagnostic.IDE0051.severity = warning
dotnet_diagnostic.IDE0052.severity = warning
dotnet_diagnostic.IDE0058.severity = none

# --- Analyzer rule tuning ---

# CA1062: Validate arguments — C# nullable reference types handle this via Nullable=enable
dotnet_diagnostic.CA1062.severity = none

# CA1054: URI parameters should not be strings — too intrusive for builder API accepting URLs
dotnet_diagnostic.CA1054.severity = none

# CA1848: Use LoggerMessage delegates — premature optimization for this project
dotnet_diagnostic.CA1848.severity = none

# MA0048: File name must match type name — nested/companion types in same file are intentional
dotnet_diagnostic.MA0048.severity = none

# MA0051: Method too long — handled by code review, not strict line limits
dotnet_diagnostic.MA0051.severity = none

# S1133: Do not forget to remove deprecated code — tracked via backlog
dotnet_diagnostic.S1133.severity = suggestion

# MA0016: Prefer collection abstraction — Dictionary/List used intentionally for internal state
dotnet_diagnostic.MA0016.severity = none

# CA1002: Do not expose List<T> — same as MA0016
dotnet_diagnostic.CA1002.severity = none

# MA0002: IEqualityComparer on string methods — StringComparison covered by CA1307
dotnet_diagnostic.MA0002.severity = none

# MA0004/CA2007: ConfigureAwait — suppressed, fixed in critical paths only
dotnet_diagnostic.MA0004.severity = suggestion
dotnet_diagnostic.CA2007.severity = suggestion

# MA0009: Regex DoS — patterns are internal, not user-controlled
dotnet_diagnostic.MA0009.severity = suggestion

# MA0006: Use string.Equals — covered by explicit StringComparison in critical paths
dotnet_diagnostic.MA0006.severity = suggestion

# MA0011: IFormatProvider — internal formatting, not user-facing
dotnet_diagnostic.MA0011.severity = none

# MA0039: Do not write dangerous content — false positive on internal logging
dotnet_diagnostic.MA0039.severity = none

# CA1031: Do not catch general exception — intentional in health checkers
dotnet_diagnostic.CA1031.severity = none

# CA1308: Use ToUpperInvariant — already fixed where applicable
dotnet_diagnostic.CA1308.severity = none

# CA5400/S4830: Certificate validation — intentional for custom TLS config
dotnet_diagnostic.CA5400.severity = none
dotnet_diagnostic.S4830.severity = none

# S6667: Logging template — not applicable to this project's patterns
dotnet_diagnostic.S6667.severity = none

# S1450: Private field only used in one method — valid design choice
dotnet_diagnostic.S1450.severity = none

# CA2000: Dispose — managed by DI and ownership patterns
dotnet_diagnostic.CA2000.severity = suggestion

# --- Shared styles ---

dotnet_naming_style.pascal_case_style.capitalization = pascal_case

dotnet_naming_style.camel_case_style.capitalization = camel_case
