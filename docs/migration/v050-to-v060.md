*[Русская версия](v050-to-v060.ru.md)*

# Migration from v0.5.0 to v0.6.0

Go SDK migration guide for the v0.6.0 release.

> This release affects **Go SDK only**. Java, Python, and C# SDKs remain at v0.5.0.

## What Changed

The `checks` package has been split into individual sub-packages. Each checker
now lives in its own package under `dephealth/checks/`:

| Old (v0.5.0) | New (v0.6.0) |
| --- | --- |
| `checks.HTTPChecker` | `httpcheck.Checker` |
| `checks.GRPCChecker` | `grpccheck.Checker` |
| `checks.TCPChecker` | `tcpcheck.Checker` |
| `checks.PostgresChecker` | `pgcheck.Checker` |
| `checks.MySQLChecker` | `mysqlcheck.Checker` |
| `checks.RedisChecker` | `redischeck.Checker` |
| `checks.AMQPChecker` | `amqpcheck.Checker` |
| `checks.KafkaChecker` | `kafkacheck.Checker` |

---

## Do I Need to Change My Code?

**If you use `dephealth.New()` with URL-based configuration** (the recommended
approach) — **no changes required**. The blank import still works:

```go
import _ "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks"
```

**If you use checker types directly** (e.g. `checks.NewHTTPChecker()`) — your
code still compiles thanks to backward-compatible aliases in `checks/compat.go`.
However, the old names are deprecated and will be removed in a future release.

---

## Selective Imports (New Feature)

You can now import only the checkers you need, reducing binary size:

```go
// v0.5.0 — all checkers (still works)
import _ "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks"

// v0.6.0 — only HTTP and Postgres
import (
    _ "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks/httpcheck"
    _ "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks/pgcheck"
)
```

Available sub-packages:

| Package | Type |
| --- | --- |
| `checks/tcpcheck` | TCP |
| `checks/httpcheck` | HTTP |
| `checks/grpccheck` | gRPC |
| `checks/pgcheck` | PostgreSQL |
| `checks/mysqlcheck` | MySQL |
| `checks/redischeck` | Redis |
| `checks/amqpcheck` | AMQP (RabbitMQ) |
| `checks/kafkacheck` | Kafka |

---

## Migrating Direct Checker Usage

If you use checker types directly, update imports to use sub-packages:

```go
// v0.5.0
import "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks"

checker := checks.NewHTTPChecker(
    checks.WithHealthPath("/ready"),
    checks.WithTLSEnabled(true),
)

// v0.6.0
import "github.com/BigKAA/topologymetrics/sdk-go/dephealth/checks/httpcheck"

checker := httpcheck.New(
    httpcheck.WithHealthPath("/ready"),
    httpcheck.WithTLSEnabled(true),
)
```

### Option Name Changes

Some option names were simplified (the checker-type prefix is no longer needed):

| Old Name | New Name |
| --- | --- |
| `WithHTTPTLSSkipVerify` | `httpcheck.WithTLSSkipVerify` |
| `WithGRPCTLS` | `grpccheck.WithTLS` |
| `WithGRPCTLSSkipVerify` | `grpccheck.WithTLSSkipVerify` |
| `WithGRPCBearerToken` | `grpccheck.WithBearerToken` |
| `WithGRPCBasicAuth` | `grpccheck.WithBasicAuth` |
| `WithPostgresDB` | `pgcheck.WithDB` |
| `WithPostgresDSN` | `pgcheck.WithDSN` |
| `WithPostgresQuery` | `pgcheck.WithQuery` |
| `WithMySQLDB` | `mysqlcheck.WithDB` |
| `WithMySQLDSN` | `mysqlcheck.WithDSN` |
| `WithMySQLQuery` | `mysqlcheck.WithQuery` |
| `WithRedisClient` | `redischeck.WithClient` |
| `WithRedisPassword` | `redischeck.WithPassword` |
| `WithRedisDB` | `redischeck.WithDB` |
| `WithAMQPURL` | `amqpcheck.WithURL` |

---

## contrib/ Packages

The `contrib/sqldb` and `contrib/redispool` packages have been updated to use
sub-packages internally. **No changes needed** in user code that uses contrib.
